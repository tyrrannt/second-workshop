# Предсказание вероятности покупки клиентом интернет-магазина

## Описание проекта

Этот проект разрабатывает модель машинного обучения для предсказания вероятности того, что клиент интернет-магазина совершит покупку в течение ближайших 90 дней. Модель направлена на помощь маркетинговому отделу в более точном таргетировании рассылок и акций, с целью повышения конверсии и оптимизации маркетинговых затрат.

Задача формулируется как бинарная классификация. Основной метрикой качества является ROC-AUC.

## Структура репозитория

```
.
├── data/                           # Директория с исходными данными (не включена в репозиторий)
│   ├── apparel-purchases.csv       # История покупок клиентов
│   ├── apparel-messages.csv        # История маркетинговых рассылок
│   ├── apparel-target_binary.csv   # Целевая переменная (покупка в течение 90 дней)
│   ├── full_campaign_daily_event.csv # Агрегированная статистика по рассылкам (по дням)
│   └── full_campaign_daily_event_channel.csv # Агрегированная статистика по рассылкам (по дням и каналам)
├── c9fe1308-57ea-4686-9221-5e9f5d46e25c.ipynb # Основной ноутбук с кодом проекта
├── requirements.txt                # Зависимости проекта (библиотеки Python)
├── README.md                       # Этот файл
└── .gitignore                      # Файл для игнoring файлов/директорий в Git (например, data/, models/, .ipynb_checkpoints)
```

## Описание данных

1.  **`apparel-purchases.csv`**: История покупок.
    *   `client_id`: Идентификатор клиента.
    *   `quantity`: Количество единиц товара.
    *   `price`: Цена единицы товара.
    *   `category_ids`: Список ID категорий товара.
    *   `date`: Дата покупки.
    *   `message_id`: ID сообщения рассылки, связанного с покупкой.
2.  **`apparel-messages.csv`**: История рассылок.
    *   `bulk_campaign_id`: Идентификатор рекламной кампании.
    *   `client_id`: Идентификатор клиента.
    *   `message_id`: Идентификатор сообщения.
    *   `event`: Тип события (отправка, открытие, клик, покупка).
    *   `channel`: Канал рассылки (email, push).
    *   `date`: Дата события.
    *   `created_at`: Время создания сообщения.
3.  **`apparel-target_binary.csv`**: Целевая переменная.
    *   `client_id`: Идентификатор клиента.
    *   `target`: 1 - клиент совершил покупку в течение 90 дней, 0 - не совершил.
4.  **`full_campaign_daily_event.csv`**: Агрегированная статистика по рассылкам по дням.
5.  **`full_campaign_daily_event_channel.csv`**: Агрегированная статистика по рассылкам по дням и каналам.

## Установка

1.  Убедитесь, что у вас установлен Python (рекомендуется 3.8 или выше).
2.  Клонируйте репозиторий:
    ```bash
    git clone <URL_вашего_репозитория>
    cd <название_папки_репозитория>
    ```
3.  (Рекомендуется) Создайте виртуальное окружение:
    ```bash
    python -m venv venv
    # Активируйте виртуальное окружение:
    # Linux/macOS:
    source venv/bin/activate
    # Windows:
    # venv\Scripts\activate
    ```
4.  Установите необходимые библиотеки:
    ```bash
    pip install -r requirements.txt
    ```

## Использование

1.  Поместите исходные CSV-файлы в директорию `data/`.
2.  Откройте и запустите Jupyter Notebook:
    ```bash
    jupyter notebook
    ```
    Откройте файл `notebook/c9fe1308-57ea-4686-9221-5e9f5d46e25c.ipynb` и выполните ячейки по порядку.

## Метрики качества

*   **Основная метрика**: ROC-AUC
*   **Дополнительные метрики**: PR-AUC, F1-score, Precision@k, Recall@k

## Результаты

(Здесь можно кратко описать результаты, например, какая модель показала лучший результат и чему равен ROC-AUC. Эти данные обычно появляются после запуска ноутбука.)

*   **Лучшая модель**: LogisticRegression
*   **ROC-AUC на тестовой выборке**: 0.7362
*   **PR-AUC на тестовой выборке**: 0.0602
*   **F1-score на тестовой выборке**: 0.0771

## Особенности проекта

*   Обработка сильного дисбаланса классов (примерно 2% положительных примеров) с использованием `class_weight='balanced'`.
*   Генерация признаков на основе истории покупок, взаимодействия с рассылками и временных данных.
*   Оценка качества с использованием ряда метрик, включая бизнес-ориентированные Precision@k и Recall@k.
